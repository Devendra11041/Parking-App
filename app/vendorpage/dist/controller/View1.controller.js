sap.ui.define(["./Basecontroller","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,r){"use strict";return e.extend("com.app.vendorpage.controller.View1",{onInit:function(){var e=new Date;var t=new Date(e);t.setDate(e.getDate());var r=this.getView().byId("idinputdatepicker");r.setMinDate(t);r.setDisplayFormat("yyyy-MM-dd");const i=new sap.ui.model.json.JSONModel({vehicleTypes:[{key:"inward",text:"inward"},{key:"outward",text:"outward"}]});this.getView().setModel(i,"vehicleTypeModel")},onReservePressbtn:async function(){debugger;var e=this.getView();var t=e.byId("InputVehicleno").getValue();var r=e.byId("InputDriverName").getValue();var i=e.byId("InputPhonenumber").getValue();var a=e.byId("InputVehicletype").getSelectedKey();var s=e.byId("idcombox1").getValue();var n=e.byId("idinputdatepicker");var o=n.getDateValue();var l=new sap.ui.model.json.JSONModel({vehicalNo:t,driverName:r,phone:i,vehicalType:a,plotNo_plot_NO:s,Expectedtime:o,notify:`Vendor ${r} requested the ${s} lot for the following time ${o}:`});this.getView().setModel(l,"newmodel");const c=this.getView().getModel("ModelV2");const d=this.getView().getModel("newmodel").getProperty("/");const u=await this.checkVehicleExists(c,t);if(u){sap.m.MessageBox.error("Vehicle number already exists. Please enter a different vehicle number.");return}try{await this.createData(c,d,"/Reservation");sap.m.MessageBox.success("Parking lot reserved successfully")}catch(e){sap.m.MessageBox.error("Failed to create reservation. Please try again.");console.error("Error creating reservation:",e)}this.onclearreservations()},checkVehicleExists:async function(e,r){debugger;return new Promise((i,a)=>{e.read("/Reservation",{filters:[new t("vehicalNo",sap.ui.model.FilterOperator.EQ,r)],success:function(e){i(e.results.length>0)},error:function(){a("An error occurred while checking vehicle number existence.")}})})},onclearreservations:function(){this.getView().byId("InputVehicleno").setValue("");this.getView().byId("InputDriverName").setValue("");this.getView().byId("InputPhonenumber").setValue("");this.getView().byId("InputVehicletype").setValue("");this.getView().byId("idcombox1").setValue("");this.getView().byId("idinputdatepicker").setValue("")}})});
//# sourceMappingURL=View1.controller.js.map